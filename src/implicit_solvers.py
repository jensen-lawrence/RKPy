# ------------------------------------------------------------------------------
# Imports
# ------------------------------------------------------------------------------

from numpy import array, sqrt
from runge_kutta import RungeKutta

# ------------------------------------------------------------------------------
# Fixed Step Methods
# ------------------------------------------------------------------------------

BackwardEuler = RungeKutta(
    name = "Backward Euler",
    A = array([[1.0]]),
    b = array([1.0]),
    c = array([1.0])
)

ImplicitMidpoint = RungeKutta(
    name = "Implicit Midpoint",
    A = array([[0.5]]),
    b = array([1.0]),
    c = array([0.5])
)

Crank_Nicolson = RungeKutta(
    name = "Crank-Nicolson",
    A = array([
        [0.0, 0.0],
        [0.5, 0.5]
    ]),
    b = array([0.5, 0.5]),
    c = array([0.0, 1.0])
)

Gauss_Legendre_2_4 = RungeKutta(
    name = "Gauss-Legendre-2-4",
    A = array([
        [0.25,                 0.25 - sqrt(3.0)/6.0],
        [0.25 + sqrt(3.0)/6.0, 0.25                ]
    ]),
    b = array([0.5, 0.5]),
    c = array([0.5 - sqrt(3.0)/6.0, 0.5 + sqrt(3.0)/6.0])
)

Gauss_Legendre_3_6 = RungeKutta(
    name = "Gauss-Legendre-3-6",
    A = array([
        [5.0/36.0,                   2.0/9.0 - sqrt(15.0)/15.0, 5.0/36.0 - sqrt(15.0)/30.0],
        [5.0/36.0 + sqrt(15.0)/24.0, 2.0/9.0,                   5.0/36.0 - sqrt(15.0)/24.0],
        [5.0/36.0 + sqrt(15.0)/30.0, 2.0/9.0 + sqrt(15.0)/15.0, 5.0/36.0                  ]
    ]),
    b = array([5.0/18.0, 4.0/9.0, 5.0/18.0]),
    c = array([0.5 - sqrt(15.0)/10.0, 0.5, 0.5 + sqrt(15.0)/10.0])
)

Kraaijevanger_Spijker_2_2 = RungeKutta(
    name = "Kraaijevanger-Spijker-2-2",
    A = array([
        [ 0.5, 0.0],
        [-0.5, 2.0]
    ]),
    b = array([-0.5, 1.5]),
    c = array([0.5, 1.5])
)

Qin_Zhang_2_2 = RungeKutta(
    name = "Qin-Zhang-2-2",
    A = array([
        [0.25, 0.0 ],
        [0.5,  0.25]
    ]),
    b = array([0.5, 0.5]),
    c = array([0.25, 0.75])
)

Crouzeix_2_3 = RungeKutta(
    name = "Crouzeix-2-3",
    A = array([
        [ 0.5 + sqrt(3.0)/6.0, 0.0                ],
        [-sqrt(3.0)/3.0,       0.5 + sqrt(3.0)/6.0]
    ]),
    b = array([0.5, 0.5]),
    c = array([0.5 + sqrt(3.0)/6.0, 0.5 - sqrt(3.0)/6.0])
)

x3 = 0.4358665215
DIRK_3_3 = RungeKutta(
    name = "DIRK-3-3",
    A = array([
        [ x3,                        0.0,                       0.0],
        [ 0.5*(1.0 - x3),            x3,                        0.0],
        [-1.5*x3**2 + 4.0*x3 - 0.25, 1.5*x3**2 - 5.0*x3 + 1.25, x3 ]
    ]),
    b = array([-1.5*x3**2 + 4.0*x3 - 0.25, 1.5*x3**2 - 5.0*x3 + 1.25, x3]),
    c = array([x3, 0.5*(1.0 + x3), 1.0])
)

DIRK_4_3 = RungeKutta(
    name = "DIRK-4-3",
    A = array([
        [ 0.5,      0.0, 0.0, 0.0],
        [ 1.0/6.0,  0.5, 0.0, 0.0],
        [-0.5,      0.5, 0.5, 0.0],
        [ 1.5,     -1.5, 0.5, 0.5]
    ]),
    b = array([1.5, -1.5, 0.5, 0.5]),
    c = array([0.5, 2.0/3.0, 0.5, 1.0])
)

x4 = 1.06857902
Norsett_3_4 = RungeKutta(
    name = "Norsett-3-4",
    A = array([
        [x4, 0.0, 0.0],
        [0.5 - x4, x4, 0.0],
        [2.0*x4, 1.0 - 4.0*x4, x4]
    ]),
    b = array([1.0/(6.0*(1.0 - 2.0*x4)**2), (3.0*(1.0 - 2.0*x4)**2 - 1.0)/(3.0*(1.0 - 2.0*x4)**2), 1.0/(6.0*(1.0 - 2.0*x4)**2)]),
    c = array([x4, 0.5, 1.0 - x4])
)

LobattoIIIA_3_4 = RungeKutta(
    name = "LobattoIIIA-3-4",
    A = array([
        [0.0,      0.0,      0.0     ],
        [5.0/24.0, 1.0/3.0, -1.0/24.0],
        [1.0/6.0,  2.0/3.0,  1.0/6.0 ]
    ]),
    b = array([1.0/6.0, 2.0/3.0, 1.0/6.0]),
    c = array([0.0, 0.5, 1.0])
)

LobattoIIIB_3_4 = RungeKutta(
    name = "LobattoIIIB-3-4",
    A = array([
        [1.0/6.0, -1.0/6.0, 0.0],
        [1.0/6.0,  1.0/3.0, 0.0],
        [1.0/6.0,  5.0/6.0, 0.0]
    ]),
    b = array([1.0/6.0, 2.0/3.0, 1.0/6.0]),
    c = array([0.0, 0.5, 1.0])
)

LobattoIIIC_3_4 = RungeKutta(
    name = "LobattoIIIC-3-4",
    A = array([
        [1.0/6.0, -1.0/3.0,   1.0/6.0 ],
        [1.0/6.0,  5.0/12.0, -1.0/12.0],
        [1.0/6.0,  2.0/3.0,   1.0/6.0 ]
    ]),
    b = array([1.0/6.0, 2.0/3.0, 1.0/6.0]),
    c = array([0.0, 0.5, 1.0])
)

LobattoIIID_3_4 = RungeKutta(
    name = "LobattoIIID-3-4",
    A = array([
        [1.0/6.0,  0.0,      -1.0/6.0],
        [1.0/12.0, 5.0/12.0,  0.0    ],
        [0.5,      1.0/3.0,   1.0/6.0]
    ]),
    b = array([1.0/6.0, 2.0/3.0, 1.0/6.0]),
    c = array([0.0, 0.5, 1.0])
)

RadauIA_2_3 = RungeKutta(
    name = "RadauIA-2-3",
    A = array([
        [0.25, -0.25    ],
        [0.25,  5.0/12.0]
    ]),
    b = array([0.25, 0.75]),
    c = array([0.0, 2.0/3.0])
)

RadauIA_3_5 = RungeKutta(
    name = "RadauIA_3_5",
    A = array([
        [1.0/9.0, (-1.0 - sqrt(6.0))/18.0,            (-1.0 + sqrt(6.0))/18.0           ],
        [1.0/9.0, 11.0/45.0 + (7.0*sqrt(6.0))/360.0,  11.0/45.0 - (43.0*sqrt(6.0))/360.0],
        [1.0/9.0, 11.0/45.0 + (43.0*sqrt(6.0))/360.0, 11.0/45.0 - (7.0*sqrt(6.0))/360.0 ]
    ]),
    b = array([1.0/9.0, 4.0/9.0 + sqrt(6.0)/36.0, 4.0/9.0 - sqrt(6.0)/36.0]),
    c = array([0.0, 0.6 - sqrt(6.0)/10.0, 0.6 + sqrt(6.0)/10.0])
)

RadauIIA_2_3 = RungeKutta(
    name = "RadauIIA-2-3",
    A = array([
        [5.0/12.0, -1.0/12.0],
        [0.75,      0.25    ]
    ]),
    b = array([0.75, 0.25]),
    c = array([1.0/3.0, 1.0])
)

RadauIIA_3_5 = RungeKutta(
    name = "RadauIIA-3-5",
    A = array([
        [11.0/45.0 - (7.0*sqrt(6.0))/360.0,     37.0/225.0 - (169.0*sqrt(6.0))/1800.0, -2.0/225.0 + sqrt(6.0)/75.0],
        [37.0/225.0 + (169.0*sqrt(6.0))/1800.0, 11.0/45.0 + (7.0*sqrt(6.0))/360.0,     -2.0/225.0 - sqrt(6.0)/75.0],
        [4.0/9.0 - sqrt(6.0)/36.0,              4.0/9.0 + sqrt(6.0)/36.0,               1.0/9.0                   ]
    ]),
    b = array([4.0/9.0 - sqrt(6.0)/36.0, 4.0/9.0 + sqrt(6.0)/36.0, 1.0/9.0]),
    c = array([0.4 - sqrt(6.0)/10.0, 0.4 + sqrt(6.0)/10.0, 1.0])
)

# ------------------------------------------------------------------------------
# Adaptive Methods
# ------------------------------------------------------------------------------

SDIRK_2_1_2 = RungeKutta(
    name = "SDIRK-2-1-2",
    A = array([
        [ 1.0, 0.0],
        [-1.0, 1.0]
    ]),
    b = (array([0.5, 0.5]),
         array([1.0, 0.0])),
    c = array([1.0, 0.0])
)

Billington_3_3_2 = RungeKutta(
    name = "Billington-3-3-2",
    A = array([
        [0.292893218813, 0.0,            0.0           ],
        [0.798989873223, 0.292893218813, 0.0           ],
        [0.740789228841, 0.259210771159, 0.292893218813]
    ]),
    b = (array([0.740789228841, 0.259210771159,  0.0           ]),
         array([0.691665115992, 0.503597029883, -0.195262145876])),
    c = array([0.292893218813, 1.091883092037, 1.292893218813])
)